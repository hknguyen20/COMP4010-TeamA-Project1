---
title: "Question 1"
output:
  pdf_document: default
  html_document: default
date: "2024-04-03"
---

# **How do audio features such as `danceability`, `energy`, `valence`, and `tempo` correlate with Taylor Swift's albums' critical and public reception?** This question seeks to uncover how the aforementioned audio features correlate with the critical and public reception of Taylor Swift's albums, as indicated by Metacritic scores and user scores. It aims to identify trends that may influence an album's success.

```{r}
library(tidyverse)
library(ggcorrplot)
```


```{r}
album_song_df = read.csv("taylor_album_songs.csv")
album_df = read.csv("taylor_albums.csv")
head(album_df)
head(album_song_df)
```

```{r}
audio_feats = c("danceability", "energy", "key", "loudness", "mode", "speechiness", "acousticness", "instrumentalness", "liveness", "valence", "tempo", "time_signature", "explicit")
```


```{r}

album_song_df$explicit <- as.integer(album_song_df$explicit)

print("feat mean median")
for (feat in audio_feats) {
  cat(feat, mean(album_song_df[, feat], na.rm = TRUE), median(album_song_df[, feat], na.rm = TRUE), "\n")
  feat_plot <- ggplot(album_song_df, aes(x = !!sym(feat))) +
    #geom_density()
    geom_boxplot()
  suppressWarnings(print(feat_plot))
}
```
```{r}
filtered_feats <- append(audio_feats, "album_name")

mean_album_song_df <- subset(album_song_df, select = filtered_feats) %>%
  group_by(album_name) %>%
  summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE))) %>%
  left_join(., album_df, by = c("album_name" = "album_name"))
```

```{r}
correlation_matrix = cor(subset(mean_album_song_df, select = -c(album_name, ep, album_release)))
ggcorrplot(correlation_matrix)
correlation_matrix
```

```{r}
subset(mean_album_song_df, select = -c(album_name, ep))
```

## Assuming each song is rated the same as its album => no correlation can be found between variables:

```{r}
album_song_df_extended = subset(album_song_df, select = filtered_feats) %>%
  left_join(., album_df, by = c("album_name" = "album_name"))
correlation_matrix = cor(subset(album_song_df_extended, select = -c(album_name, ep, album_release)))
ggcorrplot(correlation_matrix)
correlation_matrix
```
